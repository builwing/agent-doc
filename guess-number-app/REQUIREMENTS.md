# GuessNumber プロジェクト要件定義書

## 🎯 プロジェクト概要

### ビジョン
数当てゲームを通じて、楽しく論理的思考を育み、幅広いユーザーがアクセスできるPWAアプリケーションを提供する。

### プロジェクト名
**GuessNumber** - インタラクティブ数当てゲーム

### プロダクトサマリー
Next.js 15 + TypeScript + PWA対応で構築された、教育的価値と娯楽性を両立した数当てゲームアプリケーション。

## 📋 ビジネス要件

### 主要目標
1. **学習支援**: 論理的思考と数学的推理能力の向上
2. **アクセシビリティ**: 年齢・能力に関係なく楽しめるインクルーシブな体験
3. **エンゲージメント**: 継続的にプレイしたくなる仕組み
4. **技術革新**: 最新のWeb技術を活用したPWA体験

### ターゲットユーザー

#### 主要ペルソナ
1. **小学生（8-12歳）**
   - 数学学習の補助ツールとして使用
   - 保護者と一緒にプレイ
   - 短時間集中型の学習を求める

2. **中高生（13-18歳）**
   - 論理的思考の訓練として使用
   - 友達との競争を楽しむ
   - 移動時間での暇つぶしとして使用

3. **大人（19歳以上）**
   - 脳トレーニングとして使用
   - ストレス解消の手段
   - 家族との共有体験

#### サブペルソナ
- 教育関係者：授業での教材として活用
- 高齢者：認知機能維持のためのツールとして活用

### ユーザーストーリー

#### エピック1: ゲーム基本機能
- **As a プレイヤー**, I want to 数当てゲームをプレイしたい, So that 論理的思考を楽しく訓練できる
- **As a プレイヤー**, I want to 3つの難易度から選択したい, So that 自分のレベルに合わせて楽しめる
- **As a プレイヤー**, I want to ヒントを受け取りたい, So that 効果的に学習できる

#### エピック2: スコアリングと記録
- **As a プレイヤー**, I want to 自分の記録を確認したい, So that 上達を実感できる
- **As a プレイヤー**, I want to 最高記録を保存したい, So that 目標を持ってプレイできる
- **As a プレイヤー**, I want to プレイ履歴を見たい, So that 成長を振り返ることができる

#### エピック3: アクセシビリティ
- **As a 視覚に障害のあるユーザー**, I want to スクリーンリーダーで操作したい, So that 平等にゲームを楽しめる
- **As a 運動障害のあるユーザー**, I want to キーボードのみで操作したい, So that 快適にプレイできる
- **As a 高齢のユーザー**, I want to 大きな文字と明確な操作を使いたい, So that 見やすく操作しやすい

#### エピック4: PWA機能
- **As a ユーザー**, I want to オフラインでプレイしたい, So that いつでもどこでも楽しめる
- **As a ユーザー**, I want to ホーム画面にアプリを追加したい, So that ネイティブアプリのように使える

## 🎮 機能要件詳細

### コア機能

#### 1. ゲームエンジン
- **数値生成**: 暗号学的に安全な乱数生成
- **推測検証**: 入力値の妥当性チェック
- **ヒントシステム**: 段階的なヒント提供
- **タイマー機能**: 精密な制限時間管理

#### 2. 難易度システム

| 難易度 | 数値範囲 | 最大試行回数 | 制限時間 | ヒント回数 | スコア倍率 |
|--------|----------|--------------|----------|------------|------------|
| かんたん | 1-30 | 10回 | なし | 2回 | 1.0x |
| ふつう | 1-50 | 8回 | 60秒 | 1回 | 1.5x |
| むずかしい | 1-100 | 7回 | 45秒 | 0回 | 2.0x |

#### 3. スコアリングシステム

**基本スコア計算式**
```
基本点 = 1000
時間ボーナス = max(0, 残り時間 × 10)
試行ペナルティ = 使用回数 × 50
ヒントペナルティ = 使用ヒント × 100
難易度ボーナス = 基本点 × (難易度倍率 - 1.0)

最終スコア = (基本点 + 時間ボーナス - 試行ペナルティ - ヒントペナルティ + 難易度ボーナス) × 難易度倍率
```

#### 4. ヒントシステム
- **方向性ヒント**: 「もっと大きい」「もっと小さい」
- **範囲ヒント**: 「20以下」「50以上」など
- **近接ヒント**: 「とても近い」「まだ遠い」
- **段階的ヒント**: 残り回数に応じて詳細度を調整

#### 5. データ永続化
- **ローカルストレージ**: オフライン対応
- **セッション管理**: 中断・再開機能
- **統計情報**: 詳細な分析データ

### UI/UX要件

#### 1. レスポンシブデザイン
- **モバイルファースト**: 320px〜の対応
- **ブレークポイント**:
  - Mobile: 320px - 767px
  - Tablet: 768px - 1023px
  - Desktop: 1024px以上

#### 2. アクセシビリティ（WCAG 2.1 AA準拠）
- **コントラスト比**: 最小4.5:1
- **キーボード操作**: 全機能をキーボードで操作可能
- **スクリーンリーダー**: ARIA属性による完全対応
- **フォーカス管理**: 明確なフォーカスインジケーター

#### 3. アニメーション・インタラクション
- **マイクロアニメーション**: ボタンフィードバック
- **状態遷移**: スムーズな画面遷移（200ms以内）
- **プログレスインジケーター**: 処理中の明確な表示
- **リデュースドモーション**: アニメーション無効化対応

### PWA要件

#### 1. オフライン機能
- **完全オフライン対応**: ネットワーク不要でのプレイ
- **データ同期**: オンライン復帰時の設定保存
- **キャッシュ戦略**: 効率的なリソース管理

#### 2. インストール可能性
- **ウェブアプリマニフェスト**: 適切なメタデータ設定
- **サービスワーカー**: バックグラウンド処理
- **アプリアイコン**: 複数サイズ対応

#### 3. ネイティブ機能
- **プッシュ通知**: ゲーム招待・記録更新通知
- **バッジAPI**: 未読通知の表示
- **共有API**: スコア共有機能

## 📊 非機能要件

### パフォーマンス要件
- **初回ロード時間**: 2秒以内（3G接続）
- **ゲーム開始時間**: 500ms以内
- **操作レスポンス**: 100ms以内
- **Core Web Vitals**:
  - LCP: 2.5秒以内
  - FID: 100ms以内
  - CLS: 0.1以下

### セキュリティ要件
- **CSP（Content Security Policy）**: 厳格な設定
- **HTTPS必須**: 本番環境での暗号化通信
- **データ保護**: 個人情報の適切な管理
- **XSS対策**: 入力値の適切なサニタイズ

### 可用性・信頼性
- **稼働率**: 99.9%以上
- **エラー率**: 1%未満
- **復旧時間**: 30分以内
- **データバックアップ**: ローカルストレージの冗長化

### 拡張性要件
- **多言語対応**: i18n対応設計
- **テーマ機能**: ダークモード・カスタムテーマ
- **プラグイン システム**: 将来の機能拡張に対応
- **API設計**: 外部連携の可能性を考慮

## 🔧 技術制約・前提条件

### 技術スタック（確定事項）
- **フレームワーク**: Next.js 15（App Router）
- **言語**: TypeScript 5.0以上
- **スタイリング**: Tailwind CSS
- **PWA**: next-pwa
- **状態管理**: React hooks + Context API
- **テスト**: Jest + React Testing Library
- **CI/CD**: GitHub Actions

### ブラウザサポート
- **Chrome**: 90以上
- **Firefox**: 88以上
- **Safari**: 14以上
- **Edge**: 90以上
- **モバイル**: iOS Safari 14以上、Chrome Android 90以上

### パフォーマンス制約
- **バンドルサイズ**: 500KB以下（gzip圧縮後）
- **メモリ使用量**: 50MB以下
- **CPU使用率**: 10%以下（アイドル時）

## 📈 成功指標（KPI）

### エンゲージメント指標
- **日次アクティブユーザー**: 100人（初期目標）
- **平均セッション時間**: 5分以上
- **ゲーム完了率**: 80%以上
- **リピート率**: 週1回以上のプレイが60%

### 品質指標
- **クラッシュ率**: 0.1%未満
- **ロード時間**: 平均2秒以内
- **アクセシビリティスコア**: 95点以上
- **PWAスコア**: 90点以上

### ビジネス指標
- **インストール率**: 訪問者の20%
- **オフライン使用率**: インストールユーザーの50%
- **NPS（Net Promoter Score）**: 50以上

### 技術指標
- **テストカバレッジ**: 80%以上
- **型安全性**: TypeScript strict mode 100%
- **セキュリティスコア**: A+評価
- **パフォーマンスbudget**: 90点以上

## 🚀 開発フェーズ

### Phase 1: MVP（最小実行可能プロダクト）
- **期間**: 2週間
- **機能**: 
  - 基本的な数当てゲーム
  - 3つの難易度
  - スコア表示
  - ローカルストレージ保存

### Phase 2: エンハンス機能
- **期間**: 3週間
- **機能**:
  - PWA対応
  - アクセシビリティ改善
  - アニメーション追加
  - 詳細統計機能

### Phase 3: 拡張機能
- **期間**: 4週間
- **機能**:
  - 多言語対応
  - テーマ機能
  - 高度な統計分析
  - ソーシャル機能

## 🎯 受け入れ条件

### 必須条件
- [ ] 3つの難易度でゲームがプレイ可能
- [ ] スコア計算が正確に動作
- [ ] PWAとしてインストール可能
- [ ] オフラインで完全動作
- [ ] WCAG 2.1 AA準拠
- [ ] Core Web Vitals全項目クリア
- [ ] テストカバレッジ80%以上

### 望ましい条件
- [ ] アニメーションが滑らか
- [ ] 多言語対応（英語）
- [ ] ダークモード対応
- [ ] プッシュ通知対応

## 📚 参考資料

### デザインリファレンス
- Material Design 3
- Apple Human Interface Guidelines
- WCAG 2.1 ガイドライン

### 技術リファレンス
- Next.js 15 公式ドキュメント
- PWA ベストプラクティス
- TypeScript ハンドブック

## 📝 変更履歴

| バージョン | 日付 | 変更内容 | 担当者 |
|------------|------|----------|--------|
| 1.0 | 2025-08-26 | 初版作成 | requirements agent |

## 🔍 関連ドキュメント

- [SPECIFICATIONS.md](./SPECIFICATIONS.md) - 技術仕様書
- [AGENT_DEFINITIONS.md](./.claude/AGENT_DEFINITIONS.md) - エージェント定義
- [API仕様書](./.api-spec-system/specs/) - API仕様
- [各エージェント要件](./docs/agents/) - 詳細要件定義

---

この要件定義書は、GuessNumberプロジェクトの包括的な指針として機能し、すべての開発活動の基盤となります。定期的な見直しとアップデートを通じて、プロジェクトの成功を支援します。